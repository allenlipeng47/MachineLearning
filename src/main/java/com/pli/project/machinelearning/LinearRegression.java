package com.pli.project.machinelearning;

/**
 * Created by lipeng on 2016/11/26.
 */
public class LinearRegression {

    // 100 points, around y = 2x + 5, -10 < x < 10
    static double x[] = {-0.668282141, -5.656059571, -1.763096740, 5.424197922,
            -7.108235084, -0.408286341, 2.072330923, -1.385867787,
            0.451741340, -1.717143138, 0.731223621, -9.240175672,
            9.858176894, -7.261568983, 3.113671327, 1.311540296,
            3.551868461, -4.557550102, 2.419747598, -8.995011635,
            3.769071088, 7.464250880, 2.046037531, -4.150814489,
            9.572036462, 7.646970786, 7.689982052, 7.057234193,
            4.711540476, 9.403014020, 0.424665902, 8.521441231,
            3.776378725, 7.016288154, 3.123570234, -4.843442971,
            -7.229397856, -0.829950660, -0.059890915, 4.080924210,
            -4.477923331, 0.446587536, -5.608793832, 0.571035785,
            5.069863596, 6.069113417, 8.059776998, -3.257206269,
            -5.876872423, -0.368926632, 2.291691755, -0.005748053,
            -4.400760755, -1.828058437, -8.665343025, 0.362487384,
            -3.726434978, -1.309948862, 7.137582093, 2.725015869,
            5.789192999, -3.574051270, -5.110669429, 0.972497668,
            4.871638259, 6.924182195, -3.758500763, 9.930703570,
            5.179101736, -1.497000325, -6.643980173, 0.751353502,
            8.866368895, -7.167531722, -8.461068557, 4.474523282,
            -4.229108738, 9.228226054, 4.377164668, 0.429621432,
            8.642537016, 4.046125491, 3.410407398, 0.800507888,
            -6.443615677, 9.617648073, -3.804583489, 6.547870850,
            -0.270079328, -9.243630692, -4.790827022, -7.367162891,
            -7.336511328, 6.973903230, -4.884040020, -2.616959242,
            -5.137480763, 0.673313299, -9.542028215, 1.15569235};

    static double y[] = { 2.1753841,  -5.1406618,   1.5546136,  16.7781316,  -7.7432096,
            3.4824248,   8.1383155,   4.2859286,   6.2464203,   2.0804268,
            7.5661521, -17.0837028,  24.6547850,  -6.6619345,  11.5544192,
            7.2199157,  14.0809265,  -1.4882562,  11.4954697, -10.3751102,
            16.4556445,  23.8615881,   6.3303948,  -2.3558488,  23.7021893,
            24.4225945,  20.5744521,  19.5183425,  15.4017939,  25.5958772,
            8.9919044,  20.5303432,  14.4350933,  22.8221950,   8.6039664,
            -5.9655643,  -9.3936943,   6.0341063,   4.7928433,  12.8115176,
            -2.2341461,   5.4677869,  -8.1946471,   4.0940288,  12.5141162,
            18.0778971,  22.3508889,  -3.3979668,  -9.0794048,   4.0254696,
            6.5500745,   5.8857619,  -5.7485325,   4.3497835, -13.9432665,
            6.4518677,  -2.1600260,  -0.6865918,  22.1363162,   7.9805608,
            17.0520054,  -2.4076778,  -4.7672938,  10.0830373,  11.0697335,
            16.2488374,  -3.4381898,  22.2329339,  17.4326956,   2.0266091,
            13.1125143,   8.1029871,  20.2790875,  -7.1468346, -13.1214494,
            14.2672594,  -1.1557685,  21.2861556,  14.3370417,   4.6763968,
            18.7809559,  14.0246304,  10.5639226,   5.8763807,  -9.5511798,
            20.9852620,  -5.0760842,  15.7081238,   7.5839615, -15.9012079,
            -3.9677347,  -8.6880869,  -7.9409305,  21.4795560,  -2.6133709,
            0.7790350,  -3.5840669,   8.2868767, -15.6560727,   8.4223730};

        public static void main(String[] args) {
                gdCalc(x, y);
        }

        public static double[] gdCalc(double[] x, double[] y) {
                double theta0 = 1, theta1 = 1, alpha = 10;
                for (int itr = 0; itr < 100; itr++) {
                        double mse0 = 0, mse1 = 1;
                        int m = x.length;
                        for (int i = 0; i < m; i++) {
                                mse0 = theta0 + theta1 * x[i] - y[i];
                                mse1 = (theta0 + theta1 * x[i] - y[i]) * x[i];
                        }
                        mse0 /= m;
                        mse1 /= m;
                        theta0 = theta0 - alpha * mse0;
                        theta1 = theta1 - alpha * mse1;
                        System.out.println("theta0, theta1: (" + theta0 + ", " + theta1 + ")");
                }
                return new double[]{theta0, theta1};
        }

}
