package com.pli.project.machinelearning;

/**
 * Created by lipeng on 2016/11/26.
 * Generated points around y = 2x + 5. Use these points to do linear regression to find the line.
 */
public class LinearRegression {

        public static void main(String[] args) {
                gdCalc(x, y);
//                System.out.println(costFunc(5, 2, x, y));
        }

        public static double[] gdCalc(double[] x, double[] y) {
                double theta0 = 100, theta1 = 100, alpha = 0.1;
                int m = x.length;
                for (int itr = 0; itr < 100000; itr++) {
                        double mse0 = 0, mse1 = 0;
                        for (int i = 0; i < m; i++) {
                                mse0 = theta0 + theta1 * x[i] - y[i];
                                mse1 = (theta0 + theta1 * x[i] - y[i]) * x[i];
                        }
                        theta0 = theta0 - (alpha * mse0) / m;
                        theta1 = theta1 - (alpha * mse1) / m;
                        System.out.println("theta0, theta1: (" + theta0 + ", " + theta1 + "), cost: " + costFunc(theta0, theta1, x, y));
                }
                return new double[]{theta0, theta1};
        }

        public static double costFunc(double theta0, double theta1, double[] x, double[] y) {
                int m = x.length;
                double cost = 0;
                for (int i = 0; i < m; i++) {
                        cost = cost + Math.pow(theta0 + theta1 * x[i] - y[i], 2);
                }
                cost = cost / m / 2;
                return cost;
        }

        // 100 points, around y = 2x + 5, -10 < x < 10
        static double x[]
//                = {-8, -1, -4, -8,  2};
                = {-5.1848128, -3.4315972,  4.5210891, -7.8255168,  8.6696928, -1.1161146,  2.6264459,  7.0743039, -4.1060559,
                8.5797452,  9.5275518, -7.3088871, -5.2865391,  2.8044916, -4.5329886,  0.7827660,  0.1120230,  8.3045888,
                -5.0019343,  1.8706128,  5.6847204, -0.2010832,  2.0501992,  1.9036305, -8.6003407,  5.1917562, -5.9857288,
                -2.0862779,  0.1519616, -2.1132342,  2.6865812, -8.4113062,  9.6334662,  7.1453726, -2.9115145, -3.1226010,
                -3.3729343,  5.2996389, -6.8104949, -4.4510405,  3.7426388,  1.7084571,  7.3191619, -7.4692750, -8.1845331,
                6.6310720, -1.5014188, -4.0072791, -9.8812510,  5.0155838,  4.5692663, -3.6951893, -8.0688729,  0.1311046,
                1.3808096,  4.0091886, -7.4880200,  7.3468319, -7.7185917,  4.2961043,  3.1971045,  8.0848575,  0.5333825,
                -7.7527636, -5.2550656, -6.7157416,  9.7579554, -7.1178941,  3.3237518,  2.4246881,  1.0866952,  7.5511335,
                6.7687670, -0.8711154,  5.6354530,  0.9408069,  1.4095608, -8.9053313,  5.1180870,  8.5523077,  3.8409097,
                5.8436881,  5.9320390, -4.5626386,  4.8134004, -2.8201836,  9.6585053,  6.9479139,  5.4494974,  2.8170450,
                -6.9108294,  5.1180419,  4.1503767, -1.2650919, -1.2419878,  1.7175796, -2.7478937, -5.7876544, -4.6353686,
                -1.6324073};

        static double y[]
//                = {-13,   1,   0,  -9,  11};
                        = {-7.53794543,  -3.24432953,  16.45220170, -11.98744540,  21.48401404,   2.36493491,  11.09185523,
                17.64272713,  -0.32939926,  20.16895489,  25.62094245, -12.98848007,  -9.63526162,  10.38728011,
                -3.16390427,   4.57654288,   3.20540346,  20.86899140,  -4.53136331,  13.22652262,  16.46621470,
                5.07830738,  10.52598647,  11.19090928, -11.45882663,  16.32095221,  -9.23792390,   0.02555048,
                7.12185014,   0.11169746,   8.45023383, -13.04017982,  26.32456713,  16.95400485,  -2.44569939,
                -1.76432820,  -2.35937792,  17.43666023, -11.56733497,  -5.06135587,  12.81064753,   6.70304667,
                20.62647834, -13.74312073, -13.00375691,  19.31456348,   1.95006426,  -2.94452993, -15.47487940,
                14.13862726,  12.45563559,  -6.87350295, -10.93279036,   3.21205829,   7.95299180,  10.08399735,
                12.19050707,  18.18597125,  -9.74718348,  15.84432969,  13.67476646,  23.64773463,   5.17548949,
                10.22778117,  -6.59296712,  -9.12331836,  29.79867622, -10.28388790,  10.34477193,   9.11050409,
                5.92017133,  16.09254087,  15.94037981,   2.61490456,  14.90693814,   8.84121661,   6.42294155,
                10.95791531,  17.44088331,  22.88788427,  10.86148530,  19.78707455,  15.97775397,  -1.66865260,
                10.36968969,  -4.01038090,  25.56299636,  19.98554898,  16.48712398,  13.63974000,  -6.47567856,
                19.47409246,  11.99046422,   1.89496031,   2.65301035,   8.95975659,   1.48784281,  -6.89976632,
                -6.04625270,   2.30281237};

}
